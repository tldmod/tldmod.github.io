<!DOCTYPE HTML>
<!-- hi there, have a good read! -->
<html lang=en class=if-mb>
<head>
 <meta charset='utf-8'>

 <meta name=viewport    content='width=device-width, initial-scale=1'>
 <meta name=author      content='swyter'>
 <meta name=description content='Here&#39;s the official mod download page with the latest releases for Warband and Mount&amp;Blade 1.011.'>
 <meta name=keywords    content='the last days of the third age, the last days, mount and blade, mod, lotr, official, download, warband, 1.011, nightly, patches, tolkien, lord of the rings, module, total conversion'>

 <!-- twitter card data thing -->
 <meta name=twitter:card        content='summary_large_image'>
 <meta name=twitter:site        content='@tldmod'>
 <meta name=twitter:title       content='&#171;The Last Days of the Third Age&#187; Nightly patches'>
 <meta name=twitter:description content='Download our latest and finest version from here, our official page.'>
 <meta name=twitter:image       content='http://images.akamai.steamusercontent.com/ugc/630854895415240375/DB817458B3BF31DB00C5EF4130527CF625DC63E6/'>
 <meta name=twitter:creator     content='@swyterzone'>

 <title>The Last Days Â· Nightly patches</title>

 <!-- random favicon-related stuff -->
 <link rel=icon      href='favicon.ico' sizes='16x16 32x32 48x48'>
 <link rel=manifest  href='manifest.json'>
 <link rel=image_src href='http://images.akamai.steamusercontent.com/ugc/630854895415240375/DB817458B3BF31DB00C5EF4130527CF625DC63E6/'>

 <meta name=msapplication-TileColor  content='#685555'>
 <meta name=theme-color              content='#dadada'>

 <meta name=google-site-verification content='z8OFLNdGvqrfOABfPEYEipzZbVLmRPQBz6ryF7AZX-M'>
 <meta name=google-site-verification content='76_XklhKj9t-RBUzLkFuM64n7nNAK3TKnDLMIcyIxcM'>
 <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2054328004027360" crossorigin="anonymous"></script>
 
 <!-- keep /index.html out of the picture, just in case -->
 <link rel=canonical href='https://tldmod.github.io/'>
 
 <!-- swy: preload the Google font domain; fast -->
 <link href='https://fonts.gstatic.com' rel=preconnect crossorigin>
 <link href='https://fonts.googleapis.com/css?family=Merriweather:400,400italic&display=swap' rel='stylesheet preload prefetch' as=style>
 
 <!-- verify our mastodon page as a twitter backup -->
 <link rel=me href='https://mas.to/@tldmod'>
 
 <style>
  html
  {
    background: #221A18;
    color: #985;
    text-shadow: 2px 1px black;
    font-family:cursive;

            user-select: none;
    -webkit-user-select: none;
       -moz-user-select: none;
         -o-user-select: none;

    cursor: default !important;
    font-family: 'Merriweather', garamond, georgia, times, serif;

    background-image: url(img/swyTLDprofile.bg.jpg);
    height: 100%;
    width:  100%;
    height: 100%;
    background-repeat: no-repeat;
  }

  /* for screens wider than the background image */
  @media(min-width: 1349px)
  {
    html
    {
      background-position: center center;
      background-size: cover;
    }
  }
  /* swy: hide the language completion percentages when there isn't enough space */
  @media(max-width: 620px)
  {
    #languages li span { display: none !important; column-gap: 0; }
  }
  /* swy: also; reduce the amount of language rows as we run out of room */
  @media(max-width: 466px)
  {
    ul
    {
      -webkit-column-count: 2 !important;
              column-count: 2 !important;
              column-count: 2 !important; padding: 0 14px;
    }
    
    #languages li span { display: inline !important; color: darkgoldenrod; }
  }
  @media(max-width: 400px)
  {
    p[style]
    {
        height: 26px !important; margin-top: 26px !important;
        margin-bottom: 45px !important;
        margin-top: -23px;
    }
    legend { margin: 0 38px !important; }
  }
  @media(max-width: 320px)
  {
    ul
    {
      -webkit-column-count: 1 !important;
              column-count: 1 !important;
              column-count: 1 !important; padding: 0 32px;
    }
  }
    
  a[href]
  {
    color:inherit;
  }

  body
  {
    max-width: 620px;
    margin: 0 auto;
    padding: 25px;
  }

  /* swy: stole this from here: https://stackoverflow.com/a/6509239/674685 */
  ul
  {
       -moz-column-count: 3;
       -moz-column-gap:   20px;
    -webkit-column-count: 3;
    -webkit-column-gap:   20px;
            column-count: 3;
            column-gap:   20px;
  }

  ul li
  {
    list-style-type: circle;
  }

  #lang li[lang]:before
  {
    content: "";
    display: inline-block;
    /* background-image: url(img/attr(lang).png); */
    width: 16px;
    height: 11px;
    margin-right: 5px;
    image-rendering: -moz-crisp-edges; /* swy: old firefox; go figure */
    image-rendering: crisp-edges;      /* swy: firefox but not chrome */
    image-rendering: pixelated;        /* swy: chrome but not firefox */
  }

  /* shitty CSS3 implementations ftw! */

  #lang li[lang=en]:before
  {
    background-image: url(img/en.png);
  }
  #lang li[lang=es]:before
  {
    background-image: url(img/es.png);
  }
  #lang li[lang=fr]:before
  {
    background-image: url(img/fr.png);
  }
  #lang li[lang=de]:before
  {
    background-image: url(img/de.png);
  }
  #lang li[lang=pl]:before
  {
    background-image: url(img/pl.png);
  }
  #lang li[lang=ja]:before
  {
    background-image: url(img/ja.png);
  }
  #lang li[lang=ru]:before
  {
    background-image: url(img/ru.png);
  }
  #lang li[lang=it]:before
  {
    background-image: url(img/it.png);
  }
  #lang li[lang=tr]:before
  {
    background-image: url(img/tr.png);
  }
  #lang li[lang='zh-Hans']:before,
  #lang li[lang='zh-Hant']:before
  {
    background-image: url(img/zh.png);
  }
  #lang li[lang=pt-BR]:before
  {
    background-image: url(img/br.png);
  }
  #lang li[lang=sk]:before
  {
    background-image: url(img/sk.png);
  }
  #lang li[lang=ko]:before
  {
    background-image: url(img/ko.png);
  }
  
  #ul
  {
    list-style: none;
    margin: 0;
  }

  #mab1011, #warband
  {
    display: inline-block;
    background-repeat: no-repeat;
    background-size: contain;
    padding-left: 36px;
    height: 32px;
  }

  #mab1011
  {
    background-image: url(img/icon-mab1011.png);
  }

  #warband
  {
    background-image: url(img/icon-warband.png);
  }

@media only screen and ( -webkit-min-device-pixel-ratio: 1.1 ),   /* swy: HiDPI versions of the logo that kick in when we surpass 100%/96PPI: */
       only screen and (    min--moz-device-pixel-ratio: 1.1 ),   /*      https://stackoverflow.com/a/24639219/674685                         */
       only screen and (      -o-min-device-pixel-ratio: 2.6/2 ), /* returns 1.3, see Dev.Opera */
       only screen and (         min-device-pixel-ratio: 1.1 ),
       only screen and ( min-resolution: 97dpi ),
       only screen and ( min-resolution: 1.3dppx )
{
  #mab1011
  {
    background-image: url(img/icon-mab1011-hires.png);
  }

  #warband
  {
    background-image: url(img/icon-warband-hires.png);
  }
}

  input
  {
    left: -15px;
    position: relative;
    top: 22px;
    display: block;
  }

  label span
  {
    position: relative;
    top: -10px;
    padding: 10px;
  }

  ol span, .download
  {
    display: block;
    padding-left: 20px;
    margin-left: 20px;
    margin-top: 10px;
    padding-bottom: 20px;
    background-image: url(img/download.gif);
    background-repeat: no-repeat;
    image-rendering: -moz-crisp-edges; /* swy: old firefox; go figure */
    image-rendering: crisp-edges;      /* swy: firefox but not chrome */
    image-rendering: pixelated;        /* swy: chrome but not firefox */
  }

  .if-wb       if-mb, /* if we want warband don't show mb1011 */
  .if-mb       if-wb, /* if we want mb1011 don't show warband */
                 mac, /* don't show me mac text by default :) */
  .if-wb.mac not-mac  /* don't show the other wb stuff in mac */
  {
    display: none;
  }

  /* show only the mac notice if warband is selected */
  .if-wb.mac mac
  {
    display: inline;
  }

  #links
  {
    text-align:center;
  }

  noscript
  {
    position: fixed;
    display: block;
    bottom: 20px;
    margin-left: 20px;
    left: 0;
    width: 80%;
    background: rgba(0,0,0,.9);
    padding: 14px;
    border: 2px solid;
    border-radius: 5px;
    box-shadow: 2px 2px;
  }

  /* html5 tags compatibility for older browsers */
  section, article, aside, footer, header, nav, hgroup
  {
    display:block;
  }

  abbr
  {
    border-bottom: 1px dotted rgba(255, 255, 255, 0.1);
    display: inline-block;
    line-height: 15px;
  }

  p
  {
    line-height: 1.5em;
  }
  
  /* make the text-ad banner thing a bit more apparent,
     separating it from the content */
  ins.adsbygoogle
  {
    border: 1px solid;
  }
  ins.adsbygoogle:after
  {
    display: inline-block;
    font-size: x-small;
    font-family: sans-serif;
    content: 'this is an unobstrusive ad to get some revenue <3';
    background: #985;
    text-shadow: none;
    position: relative;
    color: black;
    border-radius: 0 0 10px 0;
    padding: 1px 8px;
    float: left;
    margin-top: -4px;
    margin-left: -1px;
  }
  

  a[href*=steam][href$=profileBlock]:before
  {
    position: relative;
    top: 3px;
    content: "";
    display: inline-block;
    width: 16px;
    height: 16px;
    margin-right: 4px;

    background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m151.96 418c13.572 0 26.893-6.567 34.986-18.708 12.867-19.301 7.651-45.377-11.649-58.244l-33.037-22.022c5.654-1.54 11.597-2.38 17.739-2.38 37.196 0 67.348 30.152 67.348 67.351s-30.153 67.349-67.349 67.349c-36.202 0-65.722-28.564-67.274-64.387l35.977 23.984c7.161 4.773 15.253 7.057 23.259 7.057zm274.71-418c46.937 0 85.33 38.406 85.33 85.344v341.31c0 46.968-38.393 85.342-85.33 85.342h-341.33c-46.938 0-85.344-38.375-85.344-85.341v-101.51l60.667 40.444c-5.826 31.587 3.469 65.415 27.899 89.845 39.452 39.452 103.42 39.452 142.87 0 24.234-24.231 33.575-57.715 28.039-89.082l124.53-111.49v-1e-3c23.123-3.319 45.408-13.872 63.197-31.661 43.736-43.738 43.736-114.65 0-158.39-43.74-43.739-114.65-43.739-158.39 0-17.789 17.789-28.344 40.073-31.662 63.196l-102.35 155.12c-15.924 0.816-31.689 5.382-45.863 13.695l-108.93-72.621v-138.84c0-46.938 38.405-85.344 85.343-85.344h341.33zm21.33 144c0-44.183-35.816-80-80-80s-80 35.817-80 80 35.816 80 80 80 80-35.817 80-80zm-128 0c0-26.51 21.49-48 48-48s48 21.49 48 48-21.49 48-48 48-48-21.49-48-48z"/></svg>');
    background-color: white;
    background-size: cover;
    border: 1px solid;
    border-radius: 4px;
  }
  
  div#mab1011warnbox
  {
    border: 1px solid;
    padding: 10px;
    margin: 8px;
    background: rgba(205, 133, 63, 0.07);
    margin-top: 16px;
    border-radius: 7px;
    box-shadow: 1px 1px 7px rgba(0, 0, 0, 0.3);
  }
  
  ol li:before { /* swy: make the numeric list elements ordinals: https://stackoverflow.com/a/54982988/674685 */
    counter-increment: item;
    content: "th";
    vertical-align: super;
    text-anchor: end;
    font-size: xx-small;
    position: relative;
    right: 8px;
    top: 0px;
    font-style: oblique;
    display: inline-block;
    margin-right: -1px;
  }
  ol li:nth-child(10n+1):not(:nth-child(11)):before { content: "st"; }
  ol li:nth-child(10n+2):not(:nth-child(12)):before { content: "nd"; margin-right: -7px; }
  ol li:nth-child(10n+3):not(:nth-child(13)):before { content: "rd"; }
 </style>
</head>
<body role=main>
 <header>
  <h1><em>The Last Days</em> nightly patches!</h1>
 </header>
 <p>
  <em>The Last Days of the Third Age</em> is a long-standing, community-developed Tolkien-based mod for <em>Mount&amp;Blade</em> and <em>Mount&amp;Blade Warband</em>.
 </p>
 <p>
  Nightly patches are automatically generated development builds baked by a helpful bot, which you can use to stay on the bleeding edge.<br/><br/>
  They come with the latest changes, enhancements and bug fixes, we are using a <em>rolling release</em> model so that you can stay on the loop.
 </p>
 <section id=languages>
  <h3>Included languages:</h3>
  <ul id=lang>
     <li lang=en>English</li>
     <li lang=es>Castellano</li>
     <li lang=fr>FranÃ§ais</li>
     <li lang=de>Deutsch</li>
     <li lang=ja>æ¥æ¬èª</li>
     <li lang=ru>Ð ÑÑÑÐºÐ¸Ð¹</li>
     <li lang=it>Italiano</li>
     <li lang=pl>Polski</li>
     <li lang=tr>TÃ¼rkÃ§e</li>
     <li lang=pt-BR>Brasileiro</li>
     <li lang=zh-Hans>ç®ä½ä¸­æ</li>
     <li lang=zh-Hant>ç¹é«ä¸­æ</li>
     <li lang=sk>SlovenÄina</li>
     <li lang=ko>íêµ­ì´</li>
     <li>
      <a href=https://transifex.com/tld/tld/ target=tab title='Contribute your time and help us localizing.'>Want to contribute?</a>
     </li>
  </ul>
 </section>

 <section id=instructions role=form>
  <h1>INSTRUCTIONS</h1>

  <label id=mab1011>
    <input id=mb name=dummy type=radio title='Select this to switch to the original game instructions.'>
    <span>Mount&amp;Blade 1.011</span>
  </label>
  <label id=warband>
    <input id=wb name=dummy type=radio title='Select this to switch to the Warband-related instructions.'>
    <span>Mount&amp;Blade Warband</span>
  </label>

  <if-wb><not-mac>
   <p><a target=_blank rel='noopener noreferrer' href='https://steamcommunity.com/sharedfiles/filedetails/?id=299974223#profileBlock'>Subscribe to the Steam Workshop version</a> to get automatic updates.</p>
   <p><i>(Remember to wait until the big download has completed before playing the mod!)</i></p>
   <p style="text-align: center; border-bottom: 1px solid; height: 14px; margin-bottom: 36px;"><legend style="display: inline-table; margin: 0 auto; background: rgba(34, 26, 24, 0.85) none repeat scroll 0% 0%; padding-left: 20px; padding-right: 20px; border-radius: 7px; border: 1px solid;">Or just download it manually...</legend></p>
  </not-mac></if-wb>
  <ol>
    <li>Latest standalone version of the mod for <if-wb>Warband</if-wb><if-mb>M&amp;B 1.011</if-mb> â <em>TLD_3.6<if-wb>_wb</if-wb>.7z</em>
      <span>
        Download from
       <if-mb>
        <a href=https://bitbucket.org/Swyter/tld-downloads/downloads/TLD_3.6.7z>Bitbucket</a>,
        <a href=http://www.moddb.com/mods/the-last-days/downloads/the-last-days-of-the-third-age-36-for-mb-1011#subheader>ModDB</a> or
        <a href=https://github.com/tldmod/tldmod-downloads/releases/download/nightlies/TLD_3.6.7z>GitHub</a>.
       </if-mb>
       <if-wb>
        <a href=https://bitbucket.org/Swyter/tld-downloads/downloads/TLD_3.6_wb.7z>Bitbucket</a>,
        <a href=http://www.moddb.com/mods/the-last-days/downloads/the-last-days-of-the-third-age-36-for-warband1#subheader>ModDB</a> or
        <a href=https://github.com/tldmod/tldmod-downloads/releases/download/nightlies/TLD_3.6_wb.7z>GitHub</a>.
       </if-wb>
      </span>
    </li>
    <li>
      Latest nightly patch for <if-wb>Warband</if-wb><if-mb>M&amp;B 1.011</if-mb> (from <if-wb><em id=nightly_date_warband>2020/07/24 *checking*</em></if-wb><!--
                                                                                     --><if-mb><em id=nightly_date_mab1011>2020/07/24 *checking*</em></if-mb>)
      <span>
        Download from
        <if-wb>
          <a href=https://bitbucket.org/Swyter/tld-downloads/downloads/TLD_3.6_wb_nightly_patch_2023.02.04-16.12_r3784.7z                   id=nightly_link_warband_bb>Bitbucket</a> or
          <a href=https://github.com/tldmod/tldmod-downloads/releases/download/nightlies/TLD_3.6_wb_nightly_patch_2023.02.04-16.12_r3784.7z id=nightly_link_warband_gh>GitHub</a>
        </if-wb>
        <if-mb>
          <a href=https://bitbucket.org/Swyter/tld-downloads/downloads/TLD_3.6_nightly_patch_2023.02.04-16.12_r3784.7z                   id=nightly_link_mab1011_bb>Bitbucket</a> or
          <a href=https://github.com/tldmod/tldmod-downloads/releases/download/nightlies/TLD_3.6_nightly_patch_2023.02.04-16.12_r3784.7z id=nightly_link_mab1011_gh>GitHub</a>
        </if-mb>
        <a href=https://bitbucket.org/Swyter/tld-downloads/downloads/ target=tab><em>(see more)</em></a>.
      </span>
    </li>
  </ol>

  <p>
    <b><em>To install:</em></b>
    <not-mac>
    Extract them sequentially, dragging and dropping a <em><abbr title='The Last Days of the Third Age'>TLD</abbr></em> directory inside of the

    <!-- if you think that those *blank comments* are a bit fishy and unsightly, welcome to utopia land!
         they are there to hide carriage returns to the markup parser, otherwise adds extra spaces between words -->
    <if-mb>
      <abbr title='By default the game is installed either in &#10;  Â«C:\ProgramÂ Files\Steam\SteamApps\common\mountÂ andÂ blade\modules\Â»&#10; for the Steam version or &#10;  Â«C:\ProgramÂ FilesÂ (x86)\Mount&amp;Blade\modules\Â»&#10; for the standalone version.'>
       <em>Modules</em> folder of the game<!--
   --></abbr><!--
  --></if-mb><!--

  --><if-wb>
      <abbr title='By default the game is installed either in &#10;  Â«C:\ProgramÂ FilesÂ (x86)\Steam\SteamApps\common\mountbladeÂ warband\modules\Â»&#10; for the Steam version or &#10;  Â«C:\ProgramÂ FilesÂ (x86)\Mount&amp;BladeÂ Warband\modules\Â»&#10; for the standalone version. &#10;&#10; Linux users who use Steam should install it in &#10;  Â«~/.steam/steam/steamapps/common/MountBlade Warband/ModulesÂ»'>
       <em>Modules</em> folder of the game<!--
    --></abbr><!--
  --></if-wb>, overwriting time after time.

    <if-mb>Once you are done, navigate into the <em><abbr title='The Last Days of the Third Age'>TLD</abbr></em> folder, copy a file called <em>dinput8.dll</em>, go up a few times and paste it next to <em>Mount&amp;Blade.exe</em>, into the game's root.</if-mb>

    Then just select the mod from the launcher's drop-down list and play.

    </not-mac>
    <!-- here's our mac notice, for those stylish special snowflakes -->
    <mac><!--
   -->Mac OS X users have the buggiest version of the game, a few workarounds are needed to play our mod, <a href="http://steamcommunity.com/workshop/filedetails/discussion/299974223/361787186436486677/#forum_op_361787186436486677">follow our Mac installation guide</a>.
    </mac>
  </p>
  
  <if-mb>
   <div id=mab1011warnbox>
    <b><em>Note:</em></b>
    Because of the stringent memory requirements, the only supported variant of the original game is <a href='https://web.archive.org/web/20190728043608if_/https://www.mbrepository.com/file.php?id=2595' title='Download this version of the game.'>the latest, DRM-free Â«enhanced versionÂ»</a>, with <em>Mount&amp;Blade.exe</em> patched <a href='https://www.techpowerup.com/forums/threads/large-address-aware.112556/' title='Download the suggested LAA patcher program, or do it on your own.'>as large-address aware</a>.
    <br/><br/>
    The Steam version will not work out of the box. Alternatively, you can download a pre-patched executable <a href='https://raw.githubusercontent.com/tldmod/tldmod-downloads/master/mount%26blade.exe'>from <i>here</i></a> and replace the one in the Steam folder. It is the same shareware version, with one (<abbr title='large-address aware field'>LAA</abbr>) bit toggled. No other changes.
    <br/><br/>
    Without doing this the game will either crash at startup complaining about texture files or it will crash after surpassing ~1460 MB of RAM.
   </div>
  </if-mb>

  <nav>
    <p id=links role=navigation>
      <a href=https://trello.com/b/ntzYNdEA/                                                                              title='Visit the place where we organize ourselves.'        target=tab>To-do list</a> |
      <a href=https://discord.gg/uczcz34                                                                                  title='Visit the place where our players chat and discuss.' target=tab>Discord</a> |
      <a href=https://raw.githubusercontent.com/tldmod/tldmod/master/_TLD%E2%80%94Manual%20%26%20Installation%20Guide.pdf title='Visit the comprehensive PDF help file.'              target=tab>Manual</a> |
      <a href=http://moddb.com/mods/the-last-days/                                                                        title='Visit the place where our players rate and comment.' target=tab>ModDB profile</a> |
      <a href=http://goo.gl/yIw0od                                                                                        title='Subscribe for automatic mod updates.'                target=tab>Steam Workshop</a> |
      <a href=https://mas.to/@tldmod link rel="me"                                                                        title='Visit the place where we keep you updated.'          target=tab>Mastodon</a>
    </p>
  </nav>
 </section>

 <!-- testing the addition of a small ad, just for kicks -->
 <script defer src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
 <ins class="adsbygoogle"
      style="display:block"
      data-ad-client="ca-pub-2054328004027360"
      data-ad-slot="2739187532"
      data-ad-format="auto" role="banner"></ins>
 <script>
   (adsbygoogle = window.adsbygoogle || []).push({});
 </script>

 <noscript>
   Hi. This page kind of uses JavaScript to grab the list of downloads and find the latest one.<br/>
   <br/>
   You don't seem to have it (enabled), so the download links that you'll obtain are from 2014/10/03,
   which were the most current ones at the time of me typing this,
   and may or may not be updated at yours, person of the future! :)<br/>
   <br/>
   Respectful about your browsing preferences and... well... umm... elegantly yours.<br/>
   --swyter *bows*
 </noscript>
 <script>

  /* set either the `.if_wb` or the `.if_mb` class to the root element,
     so that the css picks it up and conditionally hides whatever it needs to */
  window.onchange = function(e)
  {
    localStorage["selected_instruction"] = e.target.id;

    document.documentElement.classList.add   (e.target.id == "wb" ? "if-wb" : "if-mb");
    document.documentElement.classList.remove(e.target.id == "wb" ? "if-mb" : "if-wb");
  }

  /* hacky workaround to get it working at loading time, hell yeah! */
  var cur = localStorage["selected_instruction"] || "wb";

  document.getElementById(cur).click();
  window.onchange({ target: {id: cur} });

  /* we'll show a different description if we are on a mac and want warband */
  if (navigator.platform.toLowerCase().indexOf("mac") !== -1)
    document.documentElement.classList.add('mac');
  
  /* swyter-- tiny custom made json callback, don't judge me :) */
  function shitty_json_req(url, callback, is_raw)
  {
    xhr = new XMLHttpRequest();
    if (!is_raw)
      xhr.responseType = 'json';
    xhr.open('GET', url);
    xhr.addEventListener('loadend', function(e)
    {
      if (!is_raw && e.target.responseType != 'json') /* swy: incompatible browsers reset this back to '' */
        if (console.log("[w] manually parsing JSON response as fallback:", e.target))
          e.target.response = JSON.parse(e.target.responseText);

      if ((e.target.statusText != 'OK' && e.target.status != 200) || !e.target.response)
        if (console.error("[!] There was a network/API problem\n", e))
          return;

      callback.apply(this, [e.target.response]);
    });
    
    xhr.send();
  }
  
  /* swy: guess what? older browsers like android 4.4.2 don't support for (var i of x) constructs */
  function for_of_shim(iterate, callback)
  {
    for (var elem in iterate)
      if (iterate.hasOwnProperty(elem))
        callback(iterate[elem]);
  }

  /* here's the real meal V */
  shitty_json_req('https://api.github.com/repos/tldmod/tldmod-downloads/releases', function(json)
  {
    console.log("Starting to scrape the TLD downloads page & table!\n", json);

    /* default paleolithic date to compare against */
    window.mb_date = new Date("1992-01-01");
    window.wb_date = new Date("1992-01-01");

    for_of_shim (json[0].assets, function(entry)
    {
      var cur_date = new Date(entry.created_at);
      var cur_href = entry.browser_download_url;

      /* mab1011 link? */
      if (cur_href.indexOf("TLD_3.6_nightly_patch_") != -1 && +cur_date > +window.mb_date)
      {
        window.mb_date = cur_date;
        window.mb_href = cur_href;
      }

      /* warband link? */
      else if (cur_href.indexOf("TLD_3.6_wb_nightly_patch_") != -1 && +cur_date > +window.wb_date)
      {
        window.wb_date = cur_date;
        window.wb_href = cur_href;
      }
    }, false)
    
    console.log("Finished!\n--");

    if (window.wb_href && window.mb_href)
    {
      console.log('latest Warband nightly URL: ' + wb_href + ', uploaded on ' + wb_date);
      console.log('latest MB 1011 nightly URL: ' + mb_href + ', uploaded on ' + mb_date);

      /* probably a fine example of why js sucks,
         try to format dates in a compact way w/o ending churning out spaguetti code */

      document.getElementById("nightly_date_mab1011").textContent =             mb_date.getFullYear()            + '/' +
                                                                   ( '0' + (1 + mb_date.getMonth()) ).substr(-2) + '/' +
                                                                   ( '0' +      mb_date.getDate()   ).substr(-2);

      document.getElementById("nightly_date_warband").textContent =             wb_date.getFullYear()            + '/' +
                                                                   ( '0' + (1 + wb_date.getMonth()) ).substr(-2) + '/' +
                                                                   ( '0' +      wb_date.getDate()   ).substr(-2);

      /* replace the static links with the latest scrapped ones */
      document.getElementById("nightly_link_mab1011_gh").href = mb_href.trim();
      document.getElementById("nightly_link_warband_gh").href = wb_href.trim();
	  
      document.getElementById("nightly_link_mab1011_bb").href = 'https://api.bitbucket.org/2.0/repositories/swyter/tld-downloads/downloads/' + mb_href.trim().split('/').pop();
      document.getElementById("nightly_link_warband_bb").href = 'https://api.bitbucket.org/2.0/repositories/swyter/tld-downloads/downloads/' + wb_href.trim().split('/').pop();
    }

    else
    {
      console.error("[!] the bb downloads page couldn't be scrapped! :(");
    }

  });

  /* new! update the translation percentages live with some trickery! */
  shitty_json_req(
    'https://api.allorigins.win/raw?url=' + encodeURIComponent( /* swy: bypass cross-origin request limitations */
    'https://transifex.com/tld/tld/'), function(embedded_html)
  {
     lang_lut =
     {
                   'English': 'en',
                   'Spanish': 'es',
                   'Russian': 'ru',
                  'Japanese': 'ja',
                    'German': 'de',
                    'French': 'fr',
                   'Italian': 'it',
                    'Polish': 'pl',
                   'Turkish': 'tr',
                   'Chinese': 'zh',
                     'Czech': 'cz',
                    'Korean': 'ko',
                    'Slovak': 'sk',
       'Portuguese (Brazil)': 'pt-BR',
        'Chinese Simplified': 'zh-Hans',
       'Chinese Traditional': 'zh-Hant'
     }
 
     embedded_html_json = embedded_html.split("<script id")[1].split(">")[1].split("</script")[0];
     window.lang_perc = {}; json_contents = JSON.parse(embedded_html_json);
     console.log("[i] returned JSON from Transifex:", embedded_html_json, json_contents);
 
     /* swy: pretty, huh? i know! :( fight hacks with hacks! >:) */
     for_of_shim (json_contents.props.pageProps.data.languages, function(i)
     {
         lang_perc[lang_lut[i.name]] = i.translated_perc;
 
         console.log(
           i.code, i.name,
           lang_perc[lang_lut[i.name]] + '%'
         );
     })
 
     console.log('[!!] the Transifex language completion stats have been retrieved and parsed:', lang_perc)
 
     for_of_shim (document.querySelectorAll("#lang > li[lang]"), function(elem)
     {
       console.log(elem, elem.lang, lang_perc[elem.lang], elem.textContent, !!(elem.textContent.indexOf('%') !== -1))
 
       /* swy: now they don't have a percentage by default; unless they need them */
       if (lang_perc[elem.lang] < 100)
         elem.innerHTML += '<span> (' + lang_perc[elem.lang] + '%)</span>';
     })
   }, true);
 </script>
</body>
</html>
